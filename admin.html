<!doctype html><html lang="id"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Lezza Murlog — Admin</title><style>@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&display=swap');*{box-sizing:border-box}body{margin:0;font-family:Orbitron,monospace;background:radial-gradient(circle at top,#1a001f,#000);color:#fff;min-height:100vh;overflow-x:hidden}header{position:fixed;top:0;left:0;width:100%;background:rgba(20,0,35,.85);backdrop-filter:blur(6px);display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px 18px;border-bottom:1px solid rgba(255,255,255,.06);z-index:50}header .left{display:flex;align-items:center;gap:10px}header img{width:44px;height:44px;border-radius:50%}header h1{margin:0;color:#b74bff;font-size:1.05rem;letter-spacing:2px}header .right{display:flex;gap:10px}button{background:#b74bff;color:#fff;border:0;padding:8px 14px;border-radius:14px;cursor:pointer;font-weight:700}button:hover{background:#fff;color:#b74bff}main{padding:100px 18px 60px;max-width:1100px;margin:0 auto;display:flex;flex-wrap:wrap;gap:24px;justify-content:center}card{display:none}.card{width:360px;background:rgba(40,0,60,.36);border-radius:14px;padding:16px;border:1px solid rgba(183,75,255,.16);box-shadow:0 8px 30px rgba(183,75,255,.06)}.card h2{margin:0 0 10px;color:#b74bff;font-size:1.02rem}.inp,textarea,select{width:100%;padding:10px;border-radius:12px;border:1px solid rgba(183,75,255,.12);background:transparent;color:#fff;margin:8px 0;font-size:14px}textarea{min-height:80px;resize:vertical}.btn{display:inline-block;width:100%;padding:10px;border-radius:12px;background:#fff;color:#b74bff;font-weight:800;border:0;cursor:pointer}.btn:hover{background:#b74bff;color:#fff}.list{margin-top:12px;display:flex;flex-direction:column;gap:10px}.row{display:flex;align-items:center;justify-content:space-between;background:rgba(255,255,255,.02);padding:8px;border-radius:10px}.thumb{width:84px;height:54px;object-fit:cover;border-radius:8px;border:1px solid rgba(255,255,255,.04)}small{color:#cfc7e6}@media(max-width:760px){main{padding:100px 12px}.card{width:100%}}</style></head><body><header><div class="left"><img src="logo.png" alt="logo"/><h1>Lezza Murlog</h1></div><div class="right"><button id="vDes">Lihat Desain</button><button id="lOut">Logout</button></div></header><main><div class="card" id="uCard"><h2>Tambah Akun (Member / PT)</h2><input id="u_name" class="inp" placeholder="Username"/><input id="u_pass" class="inp" type="password" placeholder="Password"/><select id="u_type" class="inp"><option value="member">Member</option><option value="PT">PT</option></select><select id="u_dur" class="inp"><option value="7">1 Minggu</option><option value="30">1 Bulan</option><option value="permanent">Permanen</option></select><button class="btn" id="uAdd">Tambah Akun</button><div class="list" id="uList"><small>Memuat akun...</small></div></div><div class="card" id="dCard"><h2>Tambah Desain</h2><input id="d_name" class="inp" placeholder="Nama Desain (wajib)"/><textarea id="d_desc" class="inp" placeholder="Deskripsi (opsional)"></textarea><input id="d_imglink" class="inp" placeholder="Link gambar (dipakai jika tidak upload)"/><input id="d_file" class="inp" type="file" accept="image/*"/><input id="d_link" class="inp" placeholder="Link tujuan klik (opsional)"/><select id="d_access" class="inp"><option value="All">All</option><option value="PT">PT Only</option></select><small style="color:#cfc7e6;display:block;margin-top:6px">Catatan: gambar akan di-compress otomatis jika upload.</small><button class="btn" id="dAdd">Simpan Desain</button><div class="list" id="dList"><small>Memuat desain...</small></div></div></main><script>(function(){/* util */const $=(id)=>document.getElementById(id),now=()=>Date.now(),gJ=(k)=>{try{return JSON.parse(localStorage.getItem(k)||'[]')}catch(e){return[]}},sJ=(k,v)=>localStorage.setItem(k,JSON.stringify(v)),ensure=(u)=>{if(!u)return'';return/^https?:\/\//i.test(u)?u:'https://'+u},esc=(s)=>{if(!s)return'';return String(s).replace(/[&<>"'\/]/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;','/':'&#x2F;'}[c]))};/* image compress */function compressFile(f,mw=1000,mh=1000,q=0.75){return new Promise((res,rej)=>{if(!f){res('');return;}if(!f.type||!f.type.startsWith('image/'))return rej('notimage');const r=new FileReader();r.onerror=()=>rej('readerr');r.onload=e=>{const img=new Image();img.onload=()=>{let w=img.width,h=img.height,ratio=Math.min(mw/w,mh/h,1);w=Math.round(w*ratio);h=Math.round(h*ratio);const c=document.createElement('canvas');c.width=w;c.height=h;const ctx=c.getContext('2d');ctx.drawImage(img,0,0,w,h);try{const d=c.toDataURL('image/jpeg',q);res(d)}catch(err){rej('toDataErr')}};img.onerror=()=>rej('imgerr');img.src=e.target.result};r.readAsDataURL(f)})}/* auth */$('lOut').addEventListener('click',()=>{localStorage.removeItem('loggedUser');location.href='index.html'});$('vDes').addEventListener('click',()=>location.href='desain.html');function cleanUsers(){let a=gJ('users'),t=now();const alive=a.filter(x=>!x.expireAt||t<x.expireAt);if(alive.length!==a.length)sJ('users',alive);return alive}function renderUsers(){const wrap=$('uList');const arr=cleanUsers();if(!arr.length){wrap.innerHTML='<small>Belum ada akun.</small>';return}wrap.innerHTML='';arr.slice().reverse().forEach(u=>{const row=document.createElement('div');row.className='row';const s=u.expireAt?('Expire: '+new Date(u.expireAt).toLocaleDateString()):'Permanen';row.innerHTML=`<div style="display:flex;flex-direction:column;align-items:flex-start"><strong>${esc(u.username)}</strong><small style="color:#cfc7e6">${esc(u.type)} — ${esc(s)}</small></div><div><button data-u="${esc(u.username)}">Hapus</button></div>`;row.querySelector('button').addEventListener('click',()=>{if(!confirm('Hapus akun '+u.username+' ?'))return;let all=gJ('users');all=all.filter(x=>x.username!==u.username);sJ('users',all);renderUsers()});wrap.appendChild(row)})}function addUser(){const name=$('u_name').value.trim(),pw=$('u_pass').value.trim(),tp=$('u_type').value,dur=$('u_dur').value;if(!name||!pw)return alert('Isi username & password');let list=gJ('users');if(list.find(x=>x.username===name))return alert('Username sudah ada');let exp=null;if(dur!=='permanent'){exp=now()+Number(dur)*24*60*60*1000}list.push({username:name,password:pw,type:tp,expireAt:exp});sJ('users',list);$('u_name').value='';$('u_pass').value='';alert('Akun dibuat');renderUsers()}/* designs */function renderDesigns(){const wrap=$('dList');const arr=gJ('designs');if(!arr.length){wrap.innerHTML='<small>Belum ada desain.</small>';return}wrap.innerHTML='';arr.slice().reverse().forEach(d=>{const row=document.createElement('div');row.className='row';const thumb=d.image?`<img src="${d.image}" class="thumb"/>`:`<div style="width:84px;height:54px;border-radius:8px;background:rgba(255,255,255,.02);display:flex;align-items:center;justify-content:center;color:#cfc7e6">No</div>`;const meta=`<div style="flex:1;text-align:left"><strong>${esc(d.name)}</strong><small style="display:block">${esc(d.desc||'')}</small><small style="color:#b74bff">Akses: ${esc(d.access||'All')}</small></div>`;row.innerHTML=thumb+meta+`<div><button data-id="${d.id}">Hapus</button></div>`;row.querySelector('button').addEventListener('click',()=>{if(!confirm('Hapus desain ini?'))return;let a=gJ('designs');a=a.filter(x=>x.id!==d.id);sJ('designs',a);renderDesigns()});wrap.appendChild(row)})}async function addDesign(){const name=$('d_name').value.trim(),desc=$('d_desc').value.trim(),imgLink=$('d_imglink').value.trim(),file=$('d_file').files[0],target=$('d_link').value.trim(),access=$('d_access').value;if(!name)return alert('Nama desain wajib');let img='';if(file){try{img=await compressFile(file,1000,1000,0.75);const approx=Math.ceil((img.length-'data:image/jpeg;base64,'.length)*3/4);if(approx>2.5*1024*1024)img=await compressFile(file,900,900,0.6)}catch(e){console.warn('compress failed',e);try{img=URL.createObjectURL(file)}catch(er){img=''}}}else if(imgLink){img=ensure(imgLink)}else img='';const arr=gJ('designs');arr.push({id:'d_'+Math.random().toString(36).slice(2,9),name,desc,link:target||'',access,image:img,created:now()});sJ('designs',arr);$('d_name').value='';$('d_desc').value='';$('d_imglink').value='';$('d_file').value='';$('d_link').value='';alert('Desain tersimpan');renderDesigns()}/* init */$('uAdd').addEventListener('click',addUser);$('dAdd').addEventListener('click',addDesign);window.addEventListener('DOMContentLoaded',()=>{const me=JSON.parse(localStorage.getItem('loggedUser')||'null');if(!me||(me.username!=='AdMinHaMA00ZQz'&&me.type!=='admin')){alert('Akses admin.');location.href='index.html';return}renderUsers();renderDesigns()});})();</script></body></html>
